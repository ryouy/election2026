<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>衆院選2026 候補者アンケートUMAP</title>
    <link rel="stylesheet" href="./assets/css/app.css">
</head>
<body>
    <div id="left-stack">
        <div class="left-panel" id="party-panel">
            <div class="panel-title">政党選択</div>
            <div class="field">
                <span class="field-label">政党</span>
                <select id="party-select">
                    <option value="">（政党を選択）</option>
                </select>
            </div>
        </div>

        <div class="left-panel" id="party-cluster-panel">
            <div class="panel-title">党内クラスタ</div>
            <div class="field">
                <label class="toggle">
                    <input type="checkbox" id="toggle-party-clusters">
                    <span>党内クラスタ表示（他党は非表示）</span>
                </label>
                <div id="party-cluster-legend" style="display:none;"></div>
            </div>
        </div>

        <div class="left-panel" id="search-panel">
            <div class="panel-title">検索</div>
            <div id="search-container">
                <input type="text" id="search-input" placeholder="検索">
                <ul id="search-results"></ul>
            </div>
        </div>
    </div>
    
    
    <div id="control-panel">
        <div class="panel-title">表示</div>

        <div class="field">
            <span class="field-label">座標（埋め込み）</span>
            <select id="embedding-mode">
                <option value="pca_js">PCA（ブラウザ計算）</option>
                <option value="pre_umap">UMAP（事前計算）</option>
                <option value="pre_pca">PCA（事前計算）</option>
            </select>
        </div>

        <div class="field">
            <span class="field-label">設問</span>
            <select id="question-select"></select>
            <div id="question-title"></div>
            <div id="question-meta"></div>
            <div id="option-filter">
                <div class="row">
                    <select id="column-select"></select>
                    <button id="clear-option" type="button">解除</button>
                </div>
                <div id="option-chips"></div>
            </div>
        </div>

        <div class="field toggles">
            <label class="toggle"><input type="checkbox" id="toggle-cluster-outline" checked><span>クラスタ輪郭</span></label>
            <label class="toggle"><input type="checkbox" id="toggle-mismatch" checked><span>ズレ強調</span></label>
        </div>
    </div>

    <div id="tooltip"></div>

    <div id="mobile-toolbar" aria-label="Mobile controls">
        <button class="mt-btn" id="mt-party" type="button">政党/検索</button>
        <button class="mt-btn" id="mt-question" type="button">設問</button>
        <button class="mt-btn" id="mt-close" type="button">閉じる</button>
    </div>

    <div id="source-link">
        データ出典: <a href="https://www.yomiuri.co.jp/election/shugiin/2026candidates/" target="_blank" rel="noopener noreferrer">読売新聞オンライン</a>
    </div>

    <div id="legend">
        <div class="legend-title">政党一覧</div>
    </div>

    <!-- App (split from monolithic index.html) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script defer src="./assets/js/state.js"></script>
    <script defer src="./assets/js/utils.js"></script>
    <script defer src="./assets/js/embedding.js"></script>
    <script defer src="./assets/js/clustering.js"></script>
    <script defer src="./assets/js/textures.js"></script>
    <script defer src="./assets/js/ui.js"></script>
    <script defer src="./assets/js/viewer.js"></script>
    <script defer src="./assets/js/main.js"></script>

</body>
</html>
